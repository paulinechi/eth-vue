{"remainingRequest":"/home/ubuntu/eth-vue/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/ubuntu/eth-vue/src/components/sections/ProfileForm.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/ubuntu/eth-vue/src/components/sections/ProfileForm.vue","mtime":1640695749883},{"path":"/home/ubuntu/eth-vue/node_modules/babel-loader/lib/index.js","mtime":1640788501629},{"path":"/home/ubuntu/eth-vue/node_modules/cache-loader/dist/cjs.js","mtime":1640501305467},{"path":"/home/ubuntu/eth-vue/node_modules/vue-loader/lib/index.js","mtime":1640788505663}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiUHJvZmlsZUZvcm0iLAogIGRhdGE6IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlcjogdGhpcy4kc3RvcmUuc3RhdGUudXNlciwKICAgICAgaXNBZnRlck1vdW50OiBmYWxzZSwKICAgICAgcm91dGU6IHRoaXMuJHJvdXRlCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIGlzREFwcFJlYWR5OiBmdW5jdGlvbigpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmlzREFwcFJlYWR5OwogICAgfQogIH0sCiAgd2F0Y2g6IHsKICAgIGlzREFwcFJlYWR5OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLmxvZygiUHJvZmlsZUZvcm06Ojppc0RBcHBSZWFkeTogIiwgdmFsdWUpOwogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy5sb2FkUHJvZmlsZUZvcm1PclBhZ2UoKTsKICAgICAgfSk7CiAgICB9LAogICAgaXNBZnRlck1vdW50OiBmdW5jdGlvbih2YWx1ZSkgewogICAgICBjb25zb2xlLmxvZygiUHJvZmlsZUZvcm06Ojppc0FmdGVyTW91bnQ6ICIsIHZhbHVlKTsKICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewogICAgICAgIHRoaXMuc2V0QXZhdGFyKCk7CiAgICAgIH0pOwogICAgfQogIH0sCiAgbW91bnRlZDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgIHRoaXMubG9hZFByb2ZpbGVGb3JtT3JQYWdlKCk7CiAgICB9KTsKICB9LAogIG1ldGhvZHM6IHsKICAgIC4uLm1hcEFjdGlvbnMoW0FDVElPTl9UWVBFUy5MT0dJTl0pLAogICAgc2V0QXZhdGFyKGV2dCA9IG51bGwpIHsKICAgICAgY29uc3QgZW1haWwgPQogICAgICAgIGV2dCAmJiBldnQudGFyZ2V0ICYmIGV2dC50YXJnZXQudmFsdWUgIT09IHVuZGVmaW5lZAogICAgICAgICAgPyBldnQudGFyZ2V0LnZhbHVlLnRyaW0oKQogICAgICAgICAgOiB0aGlzLnVzZXIuZW1haWwudHJpbSgpOwogICAgICB0aGlzLiRyb290LmNhbGxVcGRhdGVVc2VyR3JhdmF0YXIoewogICAgICAgIGVtYWlsOiBlbWFpbCwKICAgICAgICBjYWxsYmFjazogYXZhdGFyQ2FudmFzID0+IHsKICAgICAgICAgIHRoaXMuc3R5bGVBbmRBZGRBdmF0YXJDYW52YXNUb1BhZ2UoYXZhdGFyQ2FudmFzKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIHN0eWxlQXZhdGFyQ2FudmFzKGF2YXRhckNhbnZhcykgewogICAgICBpZiAoYXZhdGFyQ2FudmFzICYmIGF2YXRhckNhbnZhcy5zdHlsZSkgewogICAgICAgIGF2YXRhckNhbnZhcy5zdHlsZS5ib3JkZXJSYWRpdXMgPSAiMTA0cHgiOwogICAgICB9CiAgICB9LAogICAgYWRkQXZhdGFyQ2FudmFzVG9QYWdlKGF2YXRhckNhbnZhcykgewogICAgICBjb25zdCBhdmF0YXJDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIuYXZhdGFyIik7CiAgICAgIGlmIChhdmF0YXJDb250YWluZXIgJiYgYXZhdGFyQ2FudmFzICYmIGF2YXRhckNhbnZhcy5zdHlsZSkgewogICAgICAgIGNvbnN0IGZvcm1lckNhbnZhcyA9IGF2YXRhckNvbnRhaW5lci5xdWVyeVNlbGVjdG9yKCJjYW52YXMiKTsKICAgICAgICBpZiAoZm9ybWVyQ2FudmFzKSB7CiAgICAgICAgICBhdmF0YXJDb250YWluZXIucmVwbGFjZUNoaWxkKGF2YXRhckNhbnZhcywgZm9ybWVyQ2FudmFzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgYXZhdGFyQ29udGFpbmVyLmFwcGVuZENoaWxkKGF2YXRhckNhbnZhcyk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgc3R5bGVBbmRBZGRBdmF0YXJDYW52YXNUb1BhZ2UoYXZhdGFyQ2FudmFzKSB7CiAgICAgIHRoaXMuc3R5bGVBdmF0YXJDYW52YXMoYXZhdGFyQ2FudmFzKTsKICAgICAgdGhpcy5hZGRBdmF0YXJDYW52YXNUb1BhZ2UoYXZhdGFyQ2FudmFzKTsKICAgIH0sCiAgICBzdWJtaXRQcm9maWxlVG9UaGVCbG9ja2NoYWluKGV2dCkgewogICAgICBpZiAoCiAgICAgICAgdGhpcy51c2VyLmZpcnN0TmFtZS50cmltKCkgPT09ICIiIHx8CiAgICAgICAgdGhpcy51c2VyLmxhc3ROYW1lLnRyaW0oKSA9PT0gIiIgfHwKICAgICAgICB0aGlzLnVzZXIuZW1haWwudHJpbSgpID09PSAiIgogICAgICApIHsKICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIud2FybmluZy1sYWJlbCIpLnN0eWxlLmRpc3BsYXkgPSAiaW5saW5lLWJsb2NrIjsKICAgICAgfSBlbHNlIHsKICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCIud2FybmluZy1sYWJlbCIpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7CiAgICAgICAgZXZ0LnRhcmdldC5kaXNhYmxlZCA9IHRydWU7CiAgICAgICAgY29uc3QgYWN0aW9uID0KICAgICAgICAgIHRoaXMuJHJvdXRlLnBhdGggPT09ICIvc2lnbi11cCIgPyAic2lnbnVwIiA6ICJlZGl0UHJvZmlsZSI7CiAgICAgICAgY29uc3QgdXNlck9iamVjdCA9IHsKICAgICAgICAgIGZpcnN0TmFtZTogYGIke3RoaXMudXNlci5maXJzdE5hbWUgfHwgIiJ9YCwKICAgICAgICAgIGxhc3ROYW1lOiBgYiR7dGhpcy51c2VyLmxhc3ROYW1lIHx8ICIifWAsCiAgICAgICAgICBlbWFpbDogYGIke3RoaXMudXNlci5lbWFpbCB8fCAiIn1gLAogICAgICAgICAgZ3JhdmF0YXI6IGAke2dldEhleEZyb21TdHJpbmcoCiAgICAgICAgICAgIHRoaXMuJHN0b3JlLnN0YXRlLAogICAgICAgICAgICB0aGlzLnVzZXIuZ3JhdmF0YXIgfHwgIiIKICAgICAgICAgICl9YAogICAgICAgIH07CgogICAgICAgIGNvbnN0IHZ1ZVVzZXJPYmplY3QgPSBPYmplY3QuYXNzaWduKHt9LCB1c2VyT2JqZWN0LCB7CiAgICAgICAgICBmaXJzdE5hbWU6IHRoaXMudXNlci5maXJzdE5hbWUgfHwgIiIsCiAgICAgICAgICBsYXN0TmFtZTogdGhpcy51c2VyLmxhc3ROYW1lIHx8ICIiLAogICAgICAgICAgZW1haWw6IHRoaXMudXNlci5lbWFpbCB8fCAiIiwKICAgICAgICAgIGdyYXZhdGFyOiB0aGlzLnVzZXIuZ3JhdmF0YXIgfHwgIiIKICAgICAgICB9KTsKCiAgICAgICAgdGhpcy4kcm9vdC5jYWxsVG9Xcml0ZVVzZXIoewogICAgICAgICAgdnVlT2JqZWN0OiB2dWVVc2VyT2JqZWN0LAogICAgICAgICAgcmVxdWVzdFBhcmFtczogdXNlck9iamVjdCwKICAgICAgICAgIGNvbnRyYWN0SW5kZXhUb1VzZTogIlVzZXJBdXRoTWFuYWdlciIsCiAgICAgICAgICBtZXRob2ROYW1lOiAic2V0VXNlciIsCiAgICAgICAgICBtYW5hZ2VySW5kZXg6ICJVc2VyTWFuYWdlciIsCiAgICAgICAgICBjYWxsYmFjazogaXNTdWNjZXNzID0+IHsKICAgICAgICAgICAgZXZ0LnRhcmdldC5kaXNhYmxlZCA9IGZhbHNlOwogICAgICAgICAgICBhbGVydCgKICAgICAgICAgICAgICBhY3Rpb24gPT09ICJzaWdudXAiCiAgICAgICAgICAgICAgICA/IGlzU3VjY2VzcwogICAgICAgICAgICAgICAgICA/ICJTaWduZWQgdXAgYW5kIGxvZ2dlZCBJbiIKICAgICAgICAgICAgICAgICAgOiAiVW5hYmxlIHRvIHNpZ24gdXAgYXQgdGhpcyB0aW1lIgogICAgICAgICAgICAgICAgOiAiU3VjY2Vzc2Z1bGx5IHVwZGF0ZWQgcHJvZmlsZSIKICAgICAgICAgICAgKTsKICAgICAgICAgICAgaWYgKHRoaXMudXNlci5lbWFpbCA9PT0gIiIgfHwgIXRoaXMudXNlci5pc0xvZ2dlZEluKSB7CiAgICAgICAgICAgICAgdGhpcy4kcm91dGVyLnB1c2goIi8iKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgiL2Rhc2hib2FyZCIpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0KICAgIH0sCiAgICBsb2FkUHJvZmlsZUZvcm1PclBhZ2UoKSB7CiAgICAgIGlmICh0aGlzLiRzdG9yZS5zdGF0ZS5jdXJyZW50Um91dGUubmFtZSA9PT0gIlByb2ZpbGVFZGl0IikgewogICAgICAgIHRoaXMuaXNBZnRlck1vdW50ID0gdHJ1ZTsKICAgICAgICB0aGlzLnNldEF2YXRhcigpOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHJvb3QuY2FsbFRvQWNjZXNzQmxvY2tjaGFpbih7CiAgICAgICAgICByZXF1ZXN0UGFyYW1zOiB7fSwKICAgICAgICAgIGNvbnRyYWN0SW5kZXhUb1VzZTogIlVzZXJBdXRoTWFuYWdlciIsCiAgICAgICAgICBtZXRob2ROYW1lOiAibG9naW4iLAogICAgICAgICAgbWFuYWdlckluZGV4OiAiVXNlck1hbmFnZXIiLAogICAgICAgICAgY2FsbGJhY2s6IChpc1VzZXJFeGlzdHMgPSBmYWxzZSkgPT4gewogICAgICAgICAgICBpZiAoaXNVc2VyRXhpc3RzKSB7CiAgICAgICAgICAgICAgdGhpcy4kcm9vdC5sb2dVc2VySW4oKTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICB0aGlzLmlzQWZ0ZXJNb3VudCA9IHRydWU7CiAgICAgICAgICAgICAgdGhpcy5zZXRBdmF0YXIoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgfQp9OwoKaW1wb3J0IHsgbWFwQWN0aW9ucyB9IGZyb20gInZ1ZXgiOwppbXBvcnQgeyBBQ1RJT05fVFlQRVMgfSBmcm9tICIuLi8uLi91dGlsL2NvbnN0YW50cyI7CmltcG9ydCB7IGdldEhleEZyb21TdHJpbmcgfSBmcm9tICIuLi8uLi9qcy91dGlsaXRpZXMiOwo="},{"version":3,"sources":["ProfileForm.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA","file":"ProfileForm.vue","sourceRoot":"src/components/sections","sourcesContent":["<template>\n  <div v-if=\"isAfterMount\" id=\"profile-form\">\n    <h3>{{ route.path === \"/sign-up\" ? \"Sign Up\" : \"Edit Profile\" }}</h3>\n    <div class=\"wrapper\">\n      <div class=\"column\">\n        <div class=\"row\">\n          <label for=\"first-name\">First name</label>\n          <input\n            id=\"first-name\"\n            v-model=\"user.firstName\"\n            type=\"text\"\n            name=\"first-name\"\n          />\n        </div>\n\n        <div class=\"row\">\n          <label for=\"last-name\">Last name</label>\n          <input\n            id=\"Last-name\"\n            v-model=\"user.lastName\"\n            type=\"text\"\n            name=\"Last-name\"\n          />\n        </div>\n\n        <div class=\"row\">\n          <label for=\"email\">Email</label>\n          <input\n            id=\"email\"\n            v-model=\"user.email\"\n            type=\"text\"\n            name=\"email\"\n            @input=\"setAvatar\"\n          />\n        </div>\n\n        <div class=\"row\">\n          <label class=\"warning-label\">Please fill all fields.</label>\n          <input\n            type=\"button\"\n            value=\"Submit\"\n            @click=\"submitProfileToTheBlockchain\"\n          />\n        </div>\n      </div>\n\n      <div class=\"avatar-column\">\n        <div class=\"avatar\" />\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  name: \"ProfileForm\",\n  data: function() {\n    return {\n      user: this.$store.state.user,\n      isAfterMount: false,\n      route: this.$route\n    };\n  },\n  computed: {\n    isDAppReady: function() {\n      return this.$store.state.isDAppReady;\n    }\n  },\n  watch: {\n    isDAppReady: function(value) {\n      console.log(\"ProfileForm:::isDAppReady: \", value);\n      this.$nextTick(() => {\n        this.loadProfileFormOrPage();\n      });\n    },\n    isAfterMount: function(value) {\n      console.log(\"ProfileForm:::isAfterMount: \", value);\n      this.$nextTick(() => {\n        this.setAvatar();\n      });\n    }\n  },\n  mounted: function() {\n    this.$nextTick(() => {\n      this.loadProfileFormOrPage();\n    });\n  },\n  methods: {\n    ...mapActions([ACTION_TYPES.LOGIN]),\n    setAvatar(evt = null) {\n      const email =\n        evt && evt.target && evt.target.value !== undefined\n          ? evt.target.value.trim()\n          : this.user.email.trim();\n      this.$root.callUpdateUserGravatar({\n        email: email,\n        callback: avatarCanvas => {\n          this.styleAndAddAvatarCanvasToPage(avatarCanvas);\n        }\n      });\n    },\n    styleAvatarCanvas(avatarCanvas) {\n      if (avatarCanvas && avatarCanvas.style) {\n        avatarCanvas.style.borderRadius = \"104px\";\n      }\n    },\n    addAvatarCanvasToPage(avatarCanvas) {\n      const avatarContainer = document.querySelector(\".avatar\");\n      if (avatarContainer && avatarCanvas && avatarCanvas.style) {\n        const formerCanvas = avatarContainer.querySelector(\"canvas\");\n        if (formerCanvas) {\n          avatarContainer.replaceChild(avatarCanvas, formerCanvas);\n        } else {\n          avatarContainer.appendChild(avatarCanvas);\n        }\n      }\n    },\n    styleAndAddAvatarCanvasToPage(avatarCanvas) {\n      this.styleAvatarCanvas(avatarCanvas);\n      this.addAvatarCanvasToPage(avatarCanvas);\n    },\n    submitProfileToTheBlockchain(evt) {\n      if (\n        this.user.firstName.trim() === \"\" ||\n        this.user.lastName.trim() === \"\" ||\n        this.user.email.trim() === \"\"\n      ) {\n        document.querySelector(\".warning-label\").style.display = \"inline-block\";\n      } else {\n        document.querySelector(\".warning-label\").style.display = \"none\";\n        evt.target.disabled = true;\n        const action =\n          this.$route.path === \"/sign-up\" ? \"signup\" : \"editProfile\";\n        const userObject = {\n          firstName: `b${this.user.firstName || \"\"}`,\n          lastName: `b${this.user.lastName || \"\"}`,\n          email: `b${this.user.email || \"\"}`,\n          gravatar: `${getHexFromString(\n            this.$store.state,\n            this.user.gravatar || \"\"\n          )}`\n        };\n\n        const vueUserObject = Object.assign({}, userObject, {\n          firstName: this.user.firstName || \"\",\n          lastName: this.user.lastName || \"\",\n          email: this.user.email || \"\",\n          gravatar: this.user.gravatar || \"\"\n        });\n\n        this.$root.callToWriteUser({\n          vueObject: vueUserObject,\n          requestParams: userObject,\n          contractIndexToUse: \"UserAuthManager\",\n          methodName: \"setUser\",\n          managerIndex: \"UserManager\",\n          callback: isSuccess => {\n            evt.target.disabled = false;\n            alert(\n              action === \"signup\"\n                ? isSuccess\n                  ? \"Signed up and logged In\"\n                  : \"Unable to sign up at this time\"\n                : \"Successfully updated profile\"\n            );\n            if (this.user.email === \"\" || !this.user.isLoggedIn) {\n              this.$router.push(\"/\");\n            } else {\n              this.$router.push(\"/dashboard\");\n            }\n          }\n        });\n      }\n    },\n    loadProfileFormOrPage() {\n      if (this.$store.state.currentRoute.name === \"ProfileEdit\") {\n        this.isAfterMount = true;\n        this.setAvatar();\n      } else {\n        this.$root.callToAccessBlockchain({\n          requestParams: {},\n          contractIndexToUse: \"UserAuthManager\",\n          methodName: \"login\",\n          managerIndex: \"UserManager\",\n          callback: (isUserExists = false) => {\n            if (isUserExists) {\n              this.$root.logUserIn();\n            } else {\n              this.isAfterMount = true;\n              this.setAvatar();\n            }\n          }\n        });\n      }\n    }\n  }\n};\n\nimport { mapActions } from \"vuex\";\nimport { ACTION_TYPES } from \"../../util/constants\";\nimport { getHexFromString } from \"../../js/utilities\";\n</script>\n\n<style scoped>\n#profile-form {\n  width: 100%;\n  height: 420px;\n  position: relative;\n  top: 100px;\n}\n\nh3 {\n  width: 100px;\n  margin: auto;\n  margin-bottom: 20px;\n}\n\n.wrapper {\n  width: 460px;\n  margin: auto;\n}\n\n.column {\n  width: 300px;\n  display: inline-block;\n}\n\n.row {\n  margin-top: 20px;\n  font-size: 14px;\n  width: 300px;\n  height: 40px;\n  display: block;\n}\n\n.avatar {\n  height: 104px;\n  width: 104px;\n  position: absolute;\n}\n\n.avatar-column {\n  height: 106px;\n  width: 106px;\n  display: inline-block;\n  position: absolute;\n  top: 60px;\n  margin-left: 20px;\n  border: 1px solid #dcdede;\n  border-radius: 106px;\n}\n\nlabel {\n  height: 100%;\n  line-height: 40px;\n  width: 100px;\n  display: inline-block;\n}\n\n.warning-label {\n  display: none;\n  width: 140px;\n  height: 20px;\n  line-height: 20px;\n  color: #ba3333;\n}\n\ninput[type=\"text\"] {\n  height: 30px;\n  line-height: 30px;\n  width: 200px;\n  display: inline-block;\n  color: #4d4c49;\n  outline: none;\n}\n\ninput {\n  height: 30px;\n  line-height: 30px;\n  width: 100px;\n  float: right;\n}\n</style>\n"]}]}